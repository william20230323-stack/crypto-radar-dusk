name: DUSK/USDT Multi-Exchange Monitor

on:
  workflow_dispatch:

jobs:
  monitor:
    name: 執行監控
    runs-on: ubuntu-latest
    
    steps:
    - name: 檢出代碼
      uses: actions/checkout@v3
    - name: 設置Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    - name: 完全修復所有類型註解
      run: |
        if [ -f "dusk_monitor.py" ]; then
          echo "完整修復 dusk_monitor.py..."
          # 移除所有類型註解
          sed -i 's/: EnhancedKLineData//g' dusk_monitor.py
          sed -i 's/: EnhancedKlineData//g' dusk_monitor.py
          sed -i 's/: str//g' dusk_monitor.py
          sed -i 's/: int//g' dusk_monitor.py
          sed -i 's/: float//g' dusk_monitor.py
          sed -i 's/: bool//g' dusk_monitor.py
          sed -i 's/: tuple//g' dusk_monitor.py
          sed -i 's/: list//g' dusk_monitor.py
          sed -i 's/: dict//g' dusk_monitor.py
          sed -i 's/-> None://g' dusk_monitor.py
          sed -i 's/-> tuple://g' dusk_monitor.py
        fi
    - name: 運行監控
      run: python dusk_monitor.py
