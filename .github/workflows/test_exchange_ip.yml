name: ğŸ” æµ‹è¯•äº¤æ˜“æ‰€IPè¿é€šæ€§

on:
  workflow_dispatch: # è¿™å…è®¸æ‚¨åœ¨ GitHub ç•Œé¢ä¸Šæ‰‹åŠ¨ç‚¹å‡»è¿è¡Œæ­¤ä»»åŠ¡

jobs:
  test-ip:
    runs-on: ubuntu-latest
    timeout-minutes: 5

    steps:
      # æ­¥éª¤1ï¼šæ£€å‡ºä»“åº“ä»£ç ï¼ˆè·å–è„šæœ¬æ‰§è¡Œç¯å¢ƒï¼‰
      - name: Checkout repository
        uses: actions/checkout@v4

      # æ­¥éª¤2ï¼šè®¾ç½®Pythonç¯å¢ƒ
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # æ­¥éª¤3ï¼šå®‰è£…å¿…è¦çš„Pythonåº“ï¼ˆä»…ccxtï¼‰
      - name: Install dependencies
        run: pip install ccxt

      # æ­¥éª¤4ï¼šæ‰§è¡ŒIPè¿é€šæ€§æµ‹è¯•è„šæœ¬
      - name: Run IP Connectivity Test
        run: |
          python << 'EOF'
          import ccxt
          import time

          def test_connection(exchange_name):
              try:
                  exchange = getattr(ccxt, exchange_name.lower())()
                  exchange.fetch_time()
                  return True
              except ccxt.NetworkError:
                  return False
              except Exception:
                  return False

          exchanges = [
              'binanceus',
              'kucoin',
              'gateio',
              'mexc',
              'huobi',
              'bitget',
              'okx'
          ]

          print("å¼€å§‹IPè¿é€šæ€§æµ‹è¯•...\\n")
          print("=" * 40)

          for exchange in exchanges:
              time.sleep(1)
              status = "å¯è¾¾" if test_connection(exchange) else "æ‹’ç»"
              print(f"{exchange:15} -> {status}")

          print("=" * 40)
          print("æµ‹è¯•ç»“æŸ")
          EOF
