name: æœ€çµ‚é€šçŸ¥æ¸¬è©¦

on:
  workflow_dispatch:

jobs:
  final-test:
    runs-on: ubuntu-latest
    
    steps:
      - name: æ¸¬è©¦é€šçŸ¥åŠŸèƒ½
        env:
          TG_TOKEN: ${{ secrets.TG_TOKEN }}
          TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }}
        run: |
          echo "ğŸ¯ æœ€çµ‚é€šçŸ¥æ¸¬è©¦"
          echo "Chat ID: $TG_CHAT_ID"
          
          python3 -c "
          import requests, os, datetime
          
          token = os.getenv('TG_TOKEN')
          chat_id = os.getenv('TG_CHAT_ID')
          
          print(f'âœ… ä½¿ç”¨ Chat ID: {chat_id}')
          
          if token and chat_id:
              now = datetime.datetime.now().strftime('%H:%M:%S')
              
              # æ¸¬è©¦1ï¼šç°¡å–®è¨Šæ¯
              print('ğŸ“¤ ç™¼é€æ¸¬è©¦è¨Šæ¯1...')
              url = f'https://api.telegram.org/bot{token}/sendMessage'
              data1 = {
                  'chat_id': chat_id,
                  'text': f'âœ… æ¸¬è©¦æˆåŠŸï¼\næ™‚é–“: {now}\nChat ID: {chat_id}'
              }
              
              try:
                  r1 = requests.post(url, json=data1, timeout=10)
                  print(f'æ¸¬è©¦1ç‹€æ…‹ç¢¼: {r1.status_code}')
                  if r1.status_code == 200:
                      print('ğŸ‰ æ¸¬è©¦1æˆåŠŸï¼è«‹æª¢æŸ¥ Telegram')
                  else:
                      print(f'æ¸¬è©¦1å¤±æ•—: {r1.text}')
              except Exception as e:
                  print(f'æ¸¬è©¦1éŒ¯èª¤: {e}')
              
              # æ¸¬è©¦2ï¼šé›·é”å•Ÿå‹•è¨Šæ¯
              print('ğŸ“¤ ç™¼é€æ¸¬è©¦è¨Šæ¯2...')
              data2 = {
                  'chat_id': chat_id,
                  'text': 'é›·é”å•Ÿå‹•åµæ¸¬'
              }
              
              try:
                  r2 = requests.post(url, json=data2, timeout=10)
                  print(f'æ¸¬è©¦2ç‹€æ…‹ç¢¼: {r2.status_code}')
                  if r2.status_code == 200:
                      print('ğŸ‰ æ¸¬è©¦2æˆåŠŸï¼')
                  else:
                      print(f'æ¸¬è©¦2å¤±æ•—: {r2.text}')
              except Exception as e:
                  print(f'æ¸¬è©¦2éŒ¯èª¤: {e}')
                  
          else:
              print('âŒ ç¼ºå°‘ç’°å¢ƒè®Šé‡')
          "
